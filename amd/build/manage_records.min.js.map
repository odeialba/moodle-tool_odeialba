{"version":3,"sources":["../src/manage_records.js"],"names":["init","addListeners","deletelinks","document","querySelectorAll","forEach","deletelink","addEventListener","e","preventDefault","anchor","target","closest","deleteNotification","dataset","id","require","str","notification","ajax","get_strings","component","done","s","confirm","call","methodname","args","data","success","courseid","refreshTable","htmltable","fail","exception","table","getElementById","parentNode","outerHTML"],"mappings":"kJAyBoB,QAAPA,CAAAA,IAAO,EAAM,CACtBC,CAAY,EACf,C,IAEKA,CAAAA,CAAY,CAAG,UAAM,CACvB,GAAMC,CAAAA,CAAW,CAAGC,QAAQ,CAACC,gBAAT,CAA0B,0BAA1B,CAApB,CAEA,GAAIF,CAAJ,CAAiB,CACbA,CAAW,CAACG,OAAZ,CAAoB,SAAAC,CAAU,CAAI,CAC9BA,CAAU,CAACC,gBAAX,CAA4B,OAA5B,CAAqC,SAACC,CAAD,CAAO,CACxCA,CAAC,CAACC,cAAF,GACA,GAAMC,CAAAA,CAAM,CAAGF,CAAC,CAACG,MAAF,CAASC,OAAT,CAAiB,GAAjB,CAAf,CAEA,GAAIF,CAAJ,CAAY,CACRG,CAAkB,CAACH,CAAM,CAACI,OAAP,CAAeC,EAAhB,CACrB,CACJ,CAPD,CAQH,CATD,CAUH,CACJ,C,CAOKF,CAAkB,CAAG,SAACE,CAAD,CAAQ,CAC/BC,OAAO,CAAC,CAAC,UAAD,CAAa,mBAAb,CAAkC,WAAlC,CAAD,CAAiD,SAASC,CAAT,CAAcC,CAAd,CAA4BC,CAA5B,CAAkC,CACtFF,CAAG,CAACG,WAAJ,CAAgB,CACZ,CAAC,IAAO,QAAR,CADY,CAEZ,CAAC,IAAO,eAAR,CAAyBC,SAAS,CAAE,eAApC,CAFY,CAGZ,CAAC,IAAO,KAAR,CAHY,CAIZ,CAAC,IAAO,IAAR,CAJY,CAAhB,EAKGC,IALH,CAKQ,SAASC,CAAT,CAAY,CAChBL,CAAY,CAACM,OAAb,CAAqBD,CAAC,CAAC,CAAD,CAAtB,CAA2BA,CAAC,CAAC,CAAD,CAA5B,CAAiCA,CAAC,CAAC,CAAD,CAAlC,CAAuCA,CAAC,CAAC,CAAD,CAAxC,CAA6C,UAAW,CACpDJ,CAAI,CAACM,IAAL,CAAU,CAAC,CACPC,UAAU,CAAE,6BADL,CAEPC,IAAI,CAAE,CAACZ,EAAE,CAAEA,CAAL,CAFC,CAGPO,IAAI,CAAE,cAASM,CAAT,CAAe,CACjB,GAAIA,CAAI,CAACC,OAAT,CAAkB,CACdV,CAAI,CAACM,IAAL,CAAU,CAAC,CACPC,UAAU,CAAE,6BADL,CAEPC,IAAI,CAAE,CAACG,QAAQ,CAAEF,CAAI,CAACE,QAAhB,CAFC,CAGPR,IAAI,CAAE,cAASM,CAAT,CAAe,CACjB,GAAIA,CAAI,CAACC,OAAT,CAAkB,CACdE,CAAY,CAACH,CAAI,CAACI,SAAN,CACf,CACJ,CAPM,CAQPC,IAAI,CAAEf,CAAY,CAACgB,SARZ,CAAD,CAAV,CAUH,CACJ,CAhBM,CAiBPD,IAAI,CAAEf,CAAY,CAACgB,SAjBZ,CAAD,CAAV,CAmBH,CApBD,CAqBH,CA3BD,EA2BGD,IA3BH,CA2BQf,CAAY,CAACgB,SA3BrB,CA4BH,CA7BM,CA8BV,C,CAEKH,CAAY,CAAG,SAACC,CAAD,CAAe,CAChC,GAAIG,CAAAA,CAAK,CAAGhC,QAAQ,CAACiC,cAAT,CAAwB,qBAAxB,EAA+CC,UAA3D,CACAF,CAAK,CAACG,SAAN,CAAkBN,CAAlB,CACA/B,CAAY,EACf,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * tool_odeialba prepare data for renderer.\n *\n * @package    tool_odeialba\n * @module     tool_odeialba/confirmation\n * @copyright  2021 Odei Alba\n * @author     Odei Alba <odeialba@odeialba.com>\n * @link       https://www.odeialba.com\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nexport const init = () => {\n    addListeners();\n};\n\nconst addListeners = () => {\n    const deletelinks = document.querySelectorAll('[data-action=\"delete\"]');\n\n    if (deletelinks) {\n        deletelinks.forEach(deletelink => {\n            deletelink.addEventListener('click', (e) => {\n                e.preventDefault();\n                const anchor = e.target.closest('a');\n\n                if (anchor) {\n                    deleteNotification(anchor.dataset.id);\n                }\n            });\n        });\n    }\n};\n\n/**\n * Display confirmation dialogue\n *\n * @param {int} id\n */\nconst deleteNotification = (id) => {\n    require(['core/str', 'core/notification', 'core/ajax'], function(str, notification, ajax) {\n        str.get_strings([\n            {'key': 'delete'},\n            {'key': 'confirmdelete', component: 'tool_odeialba'},\n            {'key': 'yes'},\n            {'key': 'no'},\n        ]).done(function(s) {\n            notification.confirm(s[0], s[1], s[2], s[3], function() {\n                ajax.call([{\n                    methodname: 'tool_odeialba_delete_record',\n                    args: {id: id},\n                    done: function(data) {\n                        if (data.success) {\n                            ajax.call([{\n                                methodname: 'tool_odeialba_display_table',\n                                args: {courseid: data.courseid},\n                                done: function(data) {\n                                    if (data.success) {\n                                        refreshTable(data.htmltable);\n                                    }\n                                },\n                                fail: notification.exception\n                            }]);\n                        }\n                    },\n                    fail: notification.exception\n                }]);\n            });\n        }).fail(notification.exception);\n    });\n};\n\nconst refreshTable = (htmltable) => {\n    var table = document.getElementById('tool_odeialba_table').parentNode;\n    table.outerHTML = htmltable;\n    addListeners();\n};\n"],"file":"manage_records.min.js"}